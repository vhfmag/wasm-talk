import { Split, Invert } from "mdx-deck/layouts";
import { Appear, Notes } from "mdx-deck";

export default Invert;

<center>

# O que muda com o WebAssembly

</center>

---

export default Invert;

# Parte 1: o que muda na Web

---

<small>O que muda na Web</small>

## Novas linguagens na Web

### Mais op√ß√µes de linguagem e acesso a novas bibliotecas

---

<small>O que muda na Web > Novas linguagens</small>

[WebSight](https://github.com/Web-Sight/WebSight), demonstra√ß√£o de uso de [OpenCV](https://opencv.org/) compilado pra WebAssembly:

![](./assets/images/websightdemo.gif)

---

<small>O que muda na Web</small>

## Polyfill de codecs

### Seu browser n√£o suporta o √∫ltimo formato de v√≠deo 360? Vai ter um polyfill pra isso

---

<iframe
  style={{ width: "90vw", height: "90vh", maxWidth: 900 }}
  src="https://brionv.com/misc/ogv.js/demo2/#file=Caminandes_3_-_Llamigos_-_Blender_Animated_Short.webm&player=native&size=360p.av1.webm&source=av1"
/>

---

<small>O que muda na Web</small>

## Jogos

### A Unity j√° exporta seus jogos pra WebAssembly _hoje_!

---

<small>O que muda na Web > Caso de estudo da Unity com WebAssembly</small>

## Benchmark da Unity (_time to screen_)

![](./assets/images/macos-performance-unity.png)

---

<small>O que muda na Web > Caso de estudo da Unity com WebAssembly</small>

## Benchmark da Unity (_code size_)

![](./assets/images/codesize-unity.png)

---

<small>O que muda na Web</small>

## Apps desktop na Web

---

<small>O que muda na Web > Apps desktop</small>

## Autocad Web

![](./assets/images/autocad-web.png)

---

<small>O que muda na Web > Apps desktop</small>

## Autocad Web

- J√° usaram Flash e JS/HTML5
  - O overhead de reimplementar em JS/ActionScript o que j√° tinham em C++ era impeditivo
- Chegaram a compilar a codebase para _asm.js_ e agora usam WebAssembly!
  - As funcionalidades de base do Autocad s√£o implementadas uma √∫nica vez e disponibilizadas em m√∫ltiplas plataformas, inclusive a Web

<small>
  <a href="https://youtu.be/BnYq7JapeDA">Pra saber mais, veja o v√≠deo</a>
</small>

---

<small>O que muda na Web > Apps desktop</small>

## Outros casos de sucesso

- O Figma [tamb√©m migrou seu web app de _asm.js_ para WebAssembly](https://www.figma.com/blog/webassembly-cut-figmas-load-time-by-3x/) e diminuiram o tempo de carregamento em **mais de 3x**
- O Google Earth voltou <strike>pra Web</strike> pro Chrome üôÑ [gra√ßas ao WebAssembly](https://medium.com/google-earth/earth-on-web-the-road-to-cross-browser-7338e0f46278)
- [O Chrome d√° suporte a PWAs em todas as plataformas desktop](https://developers.google.com/web/progressive-web-apps/desktop), integrando web apps cada vez mais com elas üéâ

<!-- ---

<small>O que muda na Web</small>

## Algoritmos pesados na Web

### ? -->

---

export default Invert;

# Parte 2: o que muda fora da Web

### <span><q>WebAssembly is not a way to run code other than JavaScript on the web; WebAssembly is a tiny, embeddable language that you can use almost anywhere</q><br/>‚Äî [WebAssembly is more than the web](https://words.steveklabnik.com/webassembly-is-more-than-just-the-web)</span>

---

<small>O que muda fora da Web</small>

## Runtimes JavaScript

### Node.js, Electron, Johnny-Five, React Native...

---

<small>Runtimes Javascript</small>

## Performance nativa no Node.js sem compila√ß√£o

A Mozilla recentemente reimplementou parte de seu m√≥dulo [sourcemap-decoder](https://npm.im/sourcemap-decoder) em WebAssembly e [o tornou de 5 a 10x mais r√°pido](https://hacks.mozilla.org/2018/01/oxidizing-source-maps-with-rust-and-webassembly/):

![](./assets/images/sourcemap-decoder-benchmark.png)

<!-- ---

## Performance nativa no Electron

[Finda](https://keminglabs.com/finda/), um app Electron para macOS, reporta [nesse post](https://keminglabs.com/blog/building-a-fast-electron-app-with-rust/) como ele usa Rust e WebAssembly para procurar por arquivos, abas abertas, hist√≥rico de navegador e muito mais em **menos de 1ms** -->

---

<small>O que muda fora da Web</small>

## Serverless

---

<small>O que muda fora da Web > Serverless</small>

## Cloudflare Workers

Cada worker √© um _isolate_ dentro de um mesmo processo do V8, enquanto na maior parte dos FaaS cada worker √© um container

![](./assets/images/cloudflare-isolates.png)

---

<small>O que muda fora da Web > Serverless</small>

## Cloudflare Workers

Isso resolve tempo de resposta pra _cold starts_

![](./assets/images/cloudflare-faas-benchmark.png)

---

<small>O que muda fora da Web > Serverless</small>

## Cloudflare Workers

- Cada novo processo do Node consome 35MB. Cada novo _isolate_, 3MB
- Elimina custo de _context switching_ do OS (~100ms)
- S√≥ permitiria a execu√ß√£o de Javascript. N√£o mais, gra√ßas a WebAssembly

---

<small>O que muda fora da Web > Serverless</small>

## Olin

> <q>[Olin](https://github.com/Xe/olin) √© (...) um primitivo de opera√ß√£o radicalmente novo para tornar mais f√°cil raciocinar sobre, fazer deploy e operar servi√ßos orientados a eventos e que seja independente (...) do computador em que ele esteja rodando.</q><br/>‚Äî https://christine.website/blog/olin-1-why-09-1-2018

<!-- esse coment√°rio √© um hack pra separar os blockquotes sem ofender o prettier :( -->

> <q>Eu quero que este projeto dure d√©cadas. Eu quero que os bin√°rios que eu suba hoje continuem funcionando daqui a 5 anos, assumindo que suas depend√™ncias al√©m desse m√≥dulo continuem funcionando.</q><br/>‚Äî https://github.com/Xe/olin

---

<small>O que muda fora da Web</small>

## Portabilidade

---

<small>O que muda fora da Web > Portabilidade</small>

## Wasmer

[wasmer](https://wasmer.io) √© um projeto ambicioso que visa permitir a cria√ß√£o de bin√°rios universais, que podem ser [diretamente executados](https://medium.com/wasmer/running-webassembly-100x-faster-%EF%B8%8F-a8237e9a372d) ou [executados por um programa](https://medium.com/wasmer/running-webassembly-from-any-language-5741f6320ccd?source=collection_home---4------0---------------------), de qualquer plataforma

---

<small>O que muda fora da Web > Portabilidade</small>

## Wasmer

[![](./assets/images/wasmer-nginx.png)](https://medium.com/@syrusakbary/running-nginx-with-webassembly-6353c02c08ac)

---

<small>O que muda fora da Web > Portabilidade</small>

## Wasmer

> A raz√£o pra usar WebAssembly n√£o √© s√≥ velocidade, mas tamb√©m portabilidade em qualquer arquitetura e isolamento de mem√≥ria de cada processo.
>
> Esses s√£o duas grandes inova√ß√µes que v√£o ser a base da nova gera√ß√£o de computa√ß√£o na nuvem.
>
> ‚Äî https://medium.com/@syrusakbary/hi-edward-d16345fb04b3

---

<small>O que muda fora da Web > Portabilidade</small>

## Outros

- [nebulet](https://github.com/nebulet/nebulet) ‚Äî um sistema operacional que roda WebAssembly nativamente
- [WasmTime](https://github.com/CraneStation/wasmtime) ‚Äî um _runtime_ de WebAssembly que implementa a [CloudABI](https://cloudabi.org), um POSIX perfeito pro WebAssembly

---

<small>O que muda fora da Web</small>

## Blockchain

---

<small>O que muda fora da Web > Blockchain</small>

## Ethereum

Hoje, o [Ethereum](https://www.ethereum.org/) implementa sua pr√≥pria [linguagem de programa√ß√£o](https://solidity.readthedocs.io/en/v0.5.6/) e sua pr√≥pria [m√°quina virtual](<https://github.com/ethereum/wiki/wiki/Ethereum-Virtual-Machine-(EVM)-Awesome-List#specification>).

A implementa√ß√£o n√£o √© ideal, e exige que cada vez mais algoritmos sejam pr√©-compilados e fa√ßam parte da VM em si.

---

<small>O que muda fora da Web > Blockchain</small>

## Ethereum

> Ao inv√©s de usar a EVM, n√≥s agora temos um excelente e eficiente conjunto de instru√ß√µes, pro qual se pode compilar todos os tipos de linguagens e ter confian√ßa de que ele vai ser execut√°vel e igualmente perform√°tico em diferentes tipos de plataformas ‚Ää‚Äî ‚Ääideal pra aplica√ß√µes decentralizadas!
>
> N√£o s√≥ dApps v√£o ficar mais r√°pidos em produ√ß√£o, como a integra√ß√£o do WASM vai tornar o desenvolvimento de _Smart Contracts_ mais acess√≠vel para pessoas j√° familiares com linguagens como Rust e Go.
>
> ‚Äî https://medium.com/zkcapital/webassembly-the-future-of-blockchain-computing-1a0ae28f7e40

---

<small>O que muda fora da Web</small>

## Outros

- Voc√™ j√° pode usar WebAssembly at√© [em FPGAs](https://github.com/piranna/wasmachine)
